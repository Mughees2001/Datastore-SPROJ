CC = gcc
CFLAGS = -Wall -pthread
LIBS = -lssl -lcrypto  # Add OpenSSL libraries here
SRC = src
BUILD = build
INCLUDE = include
MASTER_NODE_EXECUTABLE = $(BUILD)/master_node
SERVER_EXECUTABLE = $(BUILD)/server
CLIENT_EXECUTABLE = $(BUILD)client
SOURCES_MASTER_NODE = $(SRC)/master_node.c
SOURCES_SERVER = $(SRC)/server.c $(SRC)/database.c
SOURCES_CLIENT = $(SRC)/client.c
OBJECTS_MASTER_NODE = $(SOURCES_MASTER_NODE:.c=.o)
OBJECTS_SERVER = $(SOURCES_SERVER:.c=.o)
OBJECTS_CLIENT = $(SOURCES_CLIENT:.c=.o)

all: $(MASTER_NODE_EXECUTABLE) $(SERVER_EXECUTABLE) $(CLIENT_EXECUTABLE)

$(MASTER_NODE_EXECUTABLE): $(OBJECTS_MASTER_NODE)
	$(CC) $(CFLAGS) -o $(MASTER_NODE_EXECUTABLE) $(OBJECTS_MASTER_NODE) $(LIBS)

$(SERVER_EXECUTABLE): $(OBJECTS_SERVER)
	$(CC) $(CFLAGS) -o $(SERVER_EXECUTABLE) $(OBJECTS_SERVER) $(LIBS)

$(CLIENT_EXECUTABLE): $(OBJECTS_CLIENT)
	$(CC) $(CFLAGS) -o $(CLIENT_EXECUTABLE) $(OBJECTS_CLIENT) $(LIBS)

%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	rm -f $(MASTER_NODE_EXECUTABLE) $(SERVER_EXECUTABLE) $(CLIENT_EXECUTABLE) $(OBJECTS_MASTER_NODE) $(OBJECTS_SERVER) $(OBJECTS_CLIENT)
